---
layout:	post
title:	"剑指offer面试题二十九：数组中出现次数超过一半的数字"
date:	2017-1-29 14:31:02
categories:	[offer,c c++]
---

题目：数组中有一个数字出现的次数超过数组长度的一半，请找出这个数字。例如输入一个长度为9的数组{1,2,3,2,2,2,5,4,2}。由于数字2在数组中出现了5次，超过数组长度的一半，因此输出2。

本题考点：

1、考查对时间复杂度的理解。应聘者没想出一种解法，面试官都期待他能分析出这种解法的时间复杂度是多少。

2、考查思维的全面性。面试官除了要求应聘者能对有效输入返回正确的结果之外，同时也期待应聘者能对无效的输入作相应的处理。

参考代码：C/C++

```c
bool g_bInputInvalid = false;
// =================检查输入是否有效=============
bool CheckInvalidArray(int* numbers, int length)
{
    g_bInputInvalid = false;
    if(numbers == NULL && length <= 0)
        g_bInputInvalid = true;

    return g_bInputInvalid;
}
// =================检查最高频率是否超过一半============
bool CheckMoreThanHalf(int* numbers, int length, int number)
{
    int times = 0;
    for(int i = 0; i < length; ++i)
    {
        if(numbers[i] == number)
            times++;
    }
 
    bool isMoreThanHalf = true;
    if(times * 2 <= length)
    {
        g_bInputInvalid = true;
        isMoreThanHalf = false;
    }

    return isMoreThanHalf;
}

// ====================方法1====================
int MoreThanHalfNum_Solution1(int* numbers, int length)
{
    if(CheckInvalidArray(numbers, length))
        return 0;
 
    int middle = length >> 1;
    int start = 0;
    int end = length - 1;
    int index = Partition(numbers, length, start, end);
    while(index != middle)
    {
        if(index > middle)
        {
            end = index - 1;
            index = Partition(numbers, length, start, end);
        }
        else
        {
            start = index + 1;
            index = Partition(numbers, length, start, end);
        }
    }
 
    int result = numbers[middle];
    if(!CheckMoreThanHalf(numbers, length, result))
        result = 0;

    return result;
}

// ====================方法2====================
int MoreThanHalfNum_Solution2(int* numbers, int length)
{
    if(CheckInvalidArray(numbers, length))
        return 0;
 
    int result = numbers[0];
    int times = 1;
    for(int i = 1; i < length; ++i)
    {
        if(times == 0)
        {
            result = numbers[i];
            times = 1;
        }
        else if(numbers[i] == result)
            times++;
        else
            times--;
    }
 
    if(!CheckMoreThanHalf(numbers, length, result))
        result = 0;
 
    return result;
}
```

剑指offer下载：[剑指offer.pdf](https://raw.githubusercontent.com/cofire/cofire.github.io/master/source/剑指offer.pdf "剑指offer.pdf")。

源代码下载：[源代码](https://raw.githubusercontent.com/cofire/cofire.github.io/master/source/剑指offer源代码.zip "剑指offer源代码")。